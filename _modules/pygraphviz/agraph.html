<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pygraphviz.agraph &mdash; PyGraphviz 1.10rc1.dev0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="canonical" href="https://pygraphviz.github.io/documentation/stable_modules/pygraphviz/agraph.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within PyGraphviz 1.10rc1.dev0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
    <a href="https://pygraphviz.github.io/">Project Homepage</a> |
    <a href="https://github.com/pygraphviz/pygraphviz">Source Code</a>
    
            <a href="../../index.html" class="icon icon-home"> PyGraphviz
          </a>
              <div class="version">
                1.10rc1.dev0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contributor Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyGraphviz</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>pygraphviz.agraph</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    
<div class="admonition note">
<p class="admonition-title">Note</p>
  <p>This documents the development version of PyGraphviz. Documentation for the current release can be found <a href="https://pygraphviz.github.io/documentation/stable/">here</a>.</p>
</div>
    
           <div itemprop="articleBody">
             
  <h1>Source code for pygraphviz.agraph</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A Python interface to Graphviz.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">shlex</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">MutableMapping</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">io</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">graphviz</span> <span class="k">as</span> <span class="n">gv</span>

<span class="n">_DEFAULT_ENCODING</span> <span class="o">=</span> <span class="s2">&quot;UTF-8&quot;</span>


<span class="k">class</span> <span class="nc">PipeReader</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read and write pipes using threads.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">pipe</span><span class="p">):</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipe</span> <span class="o">=</span> <span class="n">pipe</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">chunk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipe</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pipe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">_Action</span><span class="p">:</span>
    <span class="n">find</span><span class="p">,</span> <span class="n">create</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>


<span class="k">class</span> <span class="nc">DotError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dot data parsing error&quot;&quot;&quot;</span>


<div class="viewcode-block" id="AGraph"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph">[docs]</a><span class="k">class</span> <span class="nc">AGraph</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class for Graphviz agraph type.</span>

<span class="sd">    Example use</span>

<span class="sd">    &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">    &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">    &gt;&gt;&gt; G = pgv.AGraph(directed=True)</span>
<span class="sd">    &gt;&gt;&gt; G = pgv.AGraph(&quot;file.dot&quot;)  # doctest: +SKIP</span>

<span class="sd">    Graphviz graph keyword parameters are processed so you may add</span>
<span class="sd">    them like</span>

<span class="sd">    &gt;&gt;&gt; G = pgv.AGraph(landscape=&quot;true&quot;, ranksep=&quot;0.1&quot;)</span>

<span class="sd">    or alternatively</span>

<span class="sd">    &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">    &gt;&gt;&gt; G.graph_attr.update(landscape=&quot;true&quot;, ranksep=&quot;0.1&quot;)</span>

<span class="sd">    and</span>

<span class="sd">    &gt;&gt;&gt; G.node_attr.update(color=&quot;red&quot;)</span>
<span class="sd">    &gt;&gt;&gt; G.edge_attr.update(len=&quot;2.0&quot;, color=&quot;blue&quot;)</span>

<span class="sd">    See http://www.graphviz.org/doc/info/attrs.html</span>
<span class="sd">    for a list of attributes.</span>

<span class="sd">    Keyword parameters:</span>

<span class="sd">    thing is a generic input type (filename, string, handle to pointer,</span>
<span class="sd">    dictionary of dictionaries).  An attempt is made to automaticaly</span>
<span class="sd">    detect the type so you may write for example:</span>

<span class="sd">    &gt;&gt;&gt; d = {&quot;1&quot;: {&quot;2&quot;: None}, &quot;2&quot;: {&quot;1&quot;: None, &quot;3&quot;: None}, &quot;3&quot;: {&quot;2&quot;: None}}</span>
<span class="sd">    &gt;&gt;&gt; A = pgv.AGraph(d)</span>
<span class="sd">    &gt;&gt;&gt; s = A.to_string()</span>
<span class="sd">    &gt;&gt;&gt; B = pgv.AGraph(s)</span>
<span class="sd">    &gt;&gt;&gt; h = B.handle</span>
<span class="sd">    &gt;&gt;&gt; C = pgv.AGraph(h)</span>

<span class="sd">    Parameters::</span>

<span class="sd">      name:    Name for the graph</span>

<span class="sd">      strict: True|False (True for simple graphs)</span>

<span class="sd">      directed: True|False</span>

<span class="sd">      data: Dictionary of dictionaries or dictionary of lists</span>
<span class="sd">      representing nodes or edges to load into initial graph</span>

<span class="sd">      string:  String containing a dot format graph</span>

<span class="sd">      handle:  Swig pointer to an agraph_t data structure</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">thing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">string</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">handle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">attr</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># assign first in case the __init__ bombs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owns_handle</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># initialization can take no arguments (gives empty graph) or</span>
        <span class="c1"># a file name</span>
        <span class="c1"># a string of graphviz dot language</span>
        <span class="c1"># a swig pointer (handle) to a graph</span>
        <span class="c1"># a dict of dicts (or dict of lists) data structure</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">has_layout</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># avoid creating members outside of init</span>

        <span class="c1"># backward compability</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="c1">#  guess input type if specified as first (nonkeyword) argument</span>
        <span class="k">if</span> <span class="n">thing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># can&#39;t specify first argument and also file,data,string,handle</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">string</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">handle</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">thing</span>  <span class="c1"># a dictionary of dictionaries (or lists)</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="s2">&quot;own&quot;</span><span class="p">):</span>  <span class="c1"># a Swig pointer - graph handle</span>
                <span class="n">handle</span> <span class="o">=</span> <span class="n">thing</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(strict)?\s*(graph|digraph).*{.*}\s*&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">thing</span><span class="p">):</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="n">thing</span>  <span class="c1"># this is a dot format graph in a string</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">thing</span>  <span class="c1"># assume this is a file name</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">):</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">thing</span>  <span class="c1"># assume this is a file name (in a path obj)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized input </span><span class="si">{</span><span class="n">thing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">handle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># if handle was specified, reference it</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">handle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_owns_handle</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># load new graph from file (creates self.handle)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">string</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># load new graph from string (creates self.handle)</span>
            <span class="c1"># get the charset from the string to properly encode it for</span>
            <span class="c1"># writing to the temporary file in from_string()</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;charset\s*=\s*&quot;([^&quot;]+)&quot;&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">_DEFAULT_ENCODING</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># no handle, need to</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># the handle was specified or created</span>
            <span class="c1"># get the encoding from the &quot;charset&quot; graph attribute</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;charset&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">item</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">bytes</span> <span class="k">else</span> <span class="n">item</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">_DEFAULT_ENCODING</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># no handle was specified or created</span>
            <span class="c1"># get encoding from the &quot;charset&quot; kwarg</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;charset&quot;</span><span class="p">,</span> <span class="n">_DEFAULT_ENCODING</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="c1"># instantiate a new, empty graph</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agraphnew</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span> <span class="n">strict</span><span class="p">,</span> <span class="n">directed</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Graph name must be a string: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># encoding is already set but if it was specified explicitly</span>
            <span class="c1"># as an attr, then set it explicitly for the graph</span>
            <span class="k">if</span> <span class="s2">&quot;charset&quot;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">:</span>
                <span class="n">gv</span><span class="o">.</span><span class="n">agattr_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;charset&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>

            <span class="c1"># if data is specified, populate the newly created graph</span>
            <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># load from dict of dicts or dict of lists</span>
                <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nbr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="c1"># throw away the charset attribute, if one exists,</span>
        <span class="c1"># since we&#39;ve already set it, and now it should not be changed</span>
        <span class="k">if</span> <span class="s2">&quot;charset&quot;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">attr</span><span class="p">[</span><span class="s2">&quot;charset&quot;</span><span class="p">]</span>

        <span class="c1"># assign any attributes specified through keywords</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_attr</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># graph attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>  <span class="c1"># apply attributes passed to init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_attr</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># default node attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge_attr</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># default edge attribtes</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ext_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">string</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnameof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;AGraph </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;AGraph </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="k">def</span> <span class="nf">_svg_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;svg&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_repr_mimebundle_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_layout</span><span class="p">:</span>
            <span class="n">repr_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;image/svg+xml&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_svg_repr</span><span class="p">()}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">repr_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;text/plain&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()}</span>
        <span class="k">return</span> <span class="n">repr_dict</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># two graphs are equal if they have exact same nodes and edges</span>
        <span class="c1"># and attributes.  This is not graph isomorphism.</span>
        <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">nodes</span><span class="p">()):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># check attributes</span>
        <span class="n">self_all_nodes_attr</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_iter</span><span class="p">())}</span>
        <span class="n">other_all_nodes_attr</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">nodes_iter</span><span class="p">())}</span>
        <span class="k">if</span> <span class="n">self_all_nodes_attr</span> <span class="o">!=</span> <span class="n">other_all_nodes_attr</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">self_all_edges_attr</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges_iter</span><span class="p">())}</span>
        <span class="n">other_all_edges_attr</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">edges_iter</span><span class="p">())}</span>
        <span class="k">if</span> <span class="n">self_all_edges_attr</span> <span class="o">!=</span> <span class="n">other_all_edges_attr</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># All checks pass.  They are equal</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># include nodes and edges in hash</span>
        <span class="c1"># Could do attributes too, but hash should be fast</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_iter</span><span class="p">())),</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges_iter</span><span class="p">())),</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># provide &quot;for n in G&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_iter</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="c1"># provide &quot;n in G&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="c1"># &quot;G[n]&quot; returns nodes attached to n</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="c1"># not implemented, but could be...</span>
    <span class="c1">#    def __setitem__(self,u,v):</span>
    <span class="c1">#        self.add_edge(u,v)</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close_handle</span><span class="p">()</span>

<div class="viewcode-block" id="AGraph.get_name"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.get_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnameof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span></div>

    <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_name</span><span class="p">)</span>

<div class="viewcode-block" id="AGraph.add_node"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.add_node">[docs]</a>    <span class="k">def</span> <span class="nf">add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a single node n.</span>

<span class="sd">        If n is not a string, conversion to a string will be attempted.</span>
<span class="sd">        String conversion will work if n has valid string representation</span>
<span class="sd">        (try str(n) if you are unsure).</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_node(&quot;a&quot;)</span>
<span class="sd">        &gt;&gt;&gt; G.nodes()</span>
<span class="sd">        [&#39;a&#39;]</span>
<span class="sd">        &gt;&gt;&gt; G.add_node(1)  # will be converted to a string</span>
<span class="sd">        &gt;&gt;&gt; G.nodes()</span>
<span class="sd">        [&#39;a&#39;, &#39;1&#39;]</span>

<span class="sd">        Attributes can be added to nodes on creation or updated after creation</span>
<span class="sd">        (attribute values must be strings)</span>

<span class="sd">        &gt;&gt;&gt; G.add_node(2, color=&quot;red&quot;)</span>

<span class="sd">        See http://www.graphviz.org/doc/info/attrs.html</span>
<span class="sd">        for a list of attributes.</span>

<span class="sd">        Anonymous Graphviz nodes are currently not implemented.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">_Action</span><span class="o">.</span><span class="n">find</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">_Action</span><span class="o">.</span><span class="n">create</span><span class="p">)</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nh</span><span class="o">=</span><span class="n">nh</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.add_nodes_from"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.add_nodes_from">[docs]</a>    <span class="k">def</span> <span class="nf">add_nodes_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add nodes from a container nbunch.</span>

<span class="sd">        nbunch can be any iterable container such as a list or dictionary</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; nlist = [&quot;a&quot;, &quot;b&quot;, 1, &quot;spam&quot;]</span>
<span class="sd">        &gt;&gt;&gt; G.add_nodes_from(nlist)</span>
<span class="sd">        &gt;&gt;&gt; sorted(G.nodes())</span>
<span class="sd">        [&#39;1&#39;, &#39;a&#39;, &#39;b&#39;, &#39;spam&#39;]</span>


<span class="sd">        Attributes can be added to nodes on creation or updated after creation</span>

<span class="sd">        &gt;&gt;&gt; G.add_nodes_from(nlist, color=&quot;red&quot;)  # set all nodes in nlist red</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nbunch</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.remove_node"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.remove_node">[docs]</a>    <span class="k">def</span> <span class="nf">remove_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the single node n.</span>

<span class="sd">        Attempting to remove a node that isn&#39;t in the graph will produce</span>
<span class="sd">        an error.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_node(&quot;a&quot;)</span>
<span class="sd">        &gt;&gt;&gt; G.remove_node(&quot;a&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">_Action</span><span class="o">.</span><span class="n">find</span><span class="p">)</span>
            <span class="n">gv</span><span class="o">.</span><span class="n">agdelnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="n">n</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span><span class="si">}</span><span class="s2"> not in graph.&quot;</span><span class="p">)</span></div>

    <span class="n">delete_node</span> <span class="o">=</span> <span class="n">remove_node</span>

<div class="viewcode-block" id="AGraph.remove_nodes_from"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.remove_nodes_from">[docs]</a>    <span class="k">def</span> <span class="nf">remove_nodes_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove nodes from a container nbunch.</span>

<span class="sd">        nbunch can be any iterable container such as a list or dictionary</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; nlist = [&quot;a&quot;, &quot;b&quot;, 1, &quot;spam&quot;]</span>
<span class="sd">        &gt;&gt;&gt; G.add_nodes_from(nlist)</span>
<span class="sd">        &gt;&gt;&gt; G.remove_nodes_from(nlist)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nbunch</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></div>

    <span class="n">delete_nodes_from</span> <span class="o">=</span> <span class="n">remove_nodes_from</span>

<div class="viewcode-block" id="AGraph.nodes_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.nodes_iter">[docs]</a>    <span class="k">def</span> <span class="nf">nodes_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an iterator over all the nodes in the graph.</span>

<span class="sd">        Note: modifying the graph structure while iterating over</span>
<span class="sd">        the nodes may produce unpredictable results.  Use nodes()</span>
<span class="sd">        as an alternative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">nh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nh</span><span class="o">=</span><span class="n">nh</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span></div>

    <span class="n">iternodes</span> <span class="o">=</span> <span class="n">nodes_iter</span>

<div class="viewcode-block" id="AGraph.nodes"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.nodes">[docs]</a>    <span class="k">def</span> <span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of all nodes in the graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_iter</span><span class="p">())</span></div>

<div class="viewcode-block" id="AGraph.number_of_nodes"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.number_of_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">number_of_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of nodes in the graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnnodes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.order"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.order">[docs]</a>    <span class="k">def</span> <span class="nf">order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of nodes in the graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span></div>

<div class="viewcode-block" id="AGraph.has_node"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.has_node">[docs]</a>    <span class="k">def</span> <span class="nf">has_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if n is in the graph or False if not.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_node(&quot;a&quot;)</span>
<span class="sd">        &gt;&gt;&gt; G.has_node(&quot;a&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; &quot;a&quot; in G  # same as G.has_node(&#39;a&#39;)</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="AGraph.get_node"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.get_node">[docs]</a>    <span class="k">def</span> <span class="nf">get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a node object (Node) corresponding to node n.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_node(&quot;a&quot;)</span>
<span class="sd">        &gt;&gt;&gt; node = G.get_node(&quot;a&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(node)</span>
<span class="sd">        a</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.add_edge"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.add_edge">[docs]</a>    <span class="k">def</span> <span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a single edge between nodes u and v.</span>

<span class="sd">        If the nodes u and v are not in the graph they will added.</span>

<span class="sd">        If u and v are not strings, conversion to a string will be attempted.</span>
<span class="sd">        String conversion will work if u and v have valid string representation</span>
<span class="sd">        (try str(u) if you are unsure).</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_edge(&quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">        &gt;&gt;&gt; G.edges()</span>
<span class="sd">        [(&#39;a&#39;, &#39;b&#39;)]</span>

<span class="sd">        The optional key argument allows assignment of a key to the</span>
<span class="sd">        edge.  This is especially useful to distinguish between</span>
<span class="sd">        parallel edges in multi-edge graphs (strict=False).</span>

<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph(strict=False)</span>
<span class="sd">        &gt;&gt;&gt; G.add_edge(&quot;a&quot;, &quot;b&quot;, &quot;first&quot;)</span>
<span class="sd">        &gt;&gt;&gt; G.add_edge(&quot;a&quot;, &quot;b&quot;, &quot;second&quot;)</span>
<span class="sd">        &gt;&gt;&gt; sorted(G.edges(keys=True))</span>
<span class="sd">        [(&#39;a&#39;, &#39;b&#39;, &#39;first&#39;), (&#39;a&#39;, &#39;b&#39;, &#39;second&#39;)]</span>

<span class="sd">        Attributes can be added when edges are created or updated after creation</span>

<span class="sd">        &gt;&gt;&gt; G.add_edge(&quot;a&quot;, &quot;b&quot;, color=&quot;green&quot;)</span>

<span class="sd">        Attributes must be valid strings.</span>

<span class="sd">        See http://www.graphviz.org/doc/info/attrs.html</span>
<span class="sd">        for a list of attributes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">u</span>  <span class="c1"># no v given, assume u is an edge tuple</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">uh</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">handle</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
            <span class="n">uh</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">handle</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">vh</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">handle</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="n">vh</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">handle</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># new</span>
            <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agedge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="n">vh</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">_Action</span><span class="o">.</span><span class="n">create</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># for strict graph, or already added</span>
            <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agedge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="n">vh</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">_Action</span><span class="o">.</span><span class="n">find</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="n">eh</span><span class="p">)</span>
        <span class="n">e</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.add_edges_from"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.add_edges_from">[docs]</a>    <span class="k">def</span> <span class="nf">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ebunch</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add nodes to graph from a container ebunch.</span>

<span class="sd">        ebunch is a container of edges such as a list or dictionary.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; elist = [(&quot;a&quot;, &quot;b&quot;), (&quot;b&quot;, &quot;c&quot;)]</span>
<span class="sd">        &gt;&gt;&gt; G.add_edges_from(elist)</span>

<span class="sd">        Attributes can be added when edges are created or updated after creation</span>

<span class="sd">        &gt;&gt;&gt; G.add_edges_from(elist, color=&quot;green&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ebunch</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.get_edge"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.get_edge">[docs]</a>    <span class="k">def</span> <span class="nf">get_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an edge object (Edge) corresponding to edge (u,v).</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_edge(&quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">        &gt;&gt;&gt; edge = G.get_edge(&quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(edge)</span>
<span class="sd">        (&#39;a&#39;, &#39;b&#39;)</span>

<span class="sd">        With optional key argument will only get edge matching (u,v,key).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.remove_edge"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.remove_edge">[docs]</a>    <span class="k">def</span> <span class="nf">remove_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove edge between nodes u and v from the graph.</span>

<span class="sd">        With optional key argument will only remove an edge</span>
<span class="sd">        matching (u,v,key).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">u</span>  <span class="c1"># no v given, assume u is an edge tuple</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">gv</span><span class="o">.</span><span class="n">agdeledge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge </span><span class="si">{</span><span class="n">u</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> not in graph.&quot;</span><span class="p">)</span></div>

    <span class="n">delete_edge</span> <span class="o">=</span> <span class="n">remove_edge</span>

<div class="viewcode-block" id="AGraph.remove_edges_from"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.remove_edges_from">[docs]</a>    <span class="k">def</span> <span class="nf">remove_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ebunch</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove edges from ebunch (a container of edges).&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ebunch</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>

    <span class="n">delete_edges_from</span> <span class="o">=</span> <span class="n">remove_edges_from</span>

<div class="viewcode-block" id="AGraph.has_edge"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.has_edge">[docs]</a>    <span class="k">def</span> <span class="nf">has_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True an edge u-v is in the graph or False if not.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_edge(&quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">        &gt;&gt;&gt; G.has_edge(&quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">        True</span>

<span class="sd">        Optional key argument will restrict match to edges (u,v,key).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">u</span>  <span class="c1"># no v given, assume u is an edge tuple</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="AGraph.edges"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.edges">[docs]</a>    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return list of edges in the graph.</span>

<span class="sd">        If the optional nbunch (container of nodes) only edges</span>
<span class="sd">        adjacent to nodes in nbunch will be returned.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_edge(&quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">        &gt;&gt;&gt; G.add_edge(&quot;c&quot;, &quot;d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(sorted(G.edges()))</span>
<span class="sd">        [(&#39;a&#39;, &#39;b&#39;), (&#39;c&#39;, &#39;d&#39;)]</span>
<span class="sd">        &gt;&gt;&gt; print(G.edges(&quot;a&quot;))</span>
<span class="sd">        [(&#39;a&#39;, &#39;b&#39;)]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="o">=</span><span class="n">nbunch</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">))</span></div>

<div class="viewcode-block" id="AGraph.has_neighbor"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.has_neighbor">[docs]</a>    <span class="k">def</span> <span class="nf">has_neighbor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if u has an edge to v or False if not.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_edge(&quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">        &gt;&gt;&gt; G.has_neighbor(&quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">        True</span>

<span class="sd">        Optional key argument will only find edges (u,v,key).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.neighbors_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.neighbors_iter">[docs]</a>    <span class="k">def</span> <span class="nf">neighbors_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return iterator over the nodes attached to n.</span>

<span class="sd">        Note: modifying the graph structure while iterating over</span>
<span class="sd">        node neighbors may produce unpredictable results.  Use neighbors()</span>
<span class="sd">        as an alternative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">nh</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">handle</span>
        <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstedge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">eh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="n">eh</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtedge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">eh</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span></div>

<div class="viewcode-block" id="AGraph.neighbors"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.neighbors">[docs]</a>    <span class="k">def</span> <span class="nf">neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of the nodes attached to n.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbors_iter</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

    <span class="n">iterneighbors</span> <span class="o">=</span> <span class="n">neighbors_iter</span>

<div class="viewcode-block" id="AGraph.out_edges_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.out_edges_iter">[docs]</a>    <span class="k">def</span> <span class="nf">out_edges_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return iterator over out edges in the graph.</span>

<span class="sd">        If the optional nbunch (container of nodes) only out edges</span>
<span class="sd">        adjacent to nodes in nbunch will be returned.</span>

<span class="sd">        Note: modifying the graph structure while iterating over</span>
<span class="sd">        edges may produce unpredictable results.  Use out_edges()</span>
<span class="sd">        as an alternative.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">nbunch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># all nodes</span>
            <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">nh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">eh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="n">eh</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">e</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">eh</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="k">return</span>
        <span class="k">elif</span> <span class="n">nbunch</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>  <span class="c1"># if nbunch is a single node</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="p">)</span>
            <span class="n">nh</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">handle</span>
            <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">eh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="n">eh</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">e</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">eh</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if nbunch is a sequence of nodes</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bunch</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nbunch</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;nbunch is not a node or a sequence of nodes.&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nbunch</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nh</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">handle</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">eh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="n">eh</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">e</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">eh</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                        <span class="k">break</span></div>

    <span class="n">iteroutedges</span> <span class="o">=</span> <span class="n">out_edges_iter</span>

<div class="viewcode-block" id="AGraph.in_edges_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.in_edges_iter">[docs]</a>    <span class="k">def</span> <span class="nf">in_edges_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return iterator over out edges in the graph.</span>

<span class="sd">        If the optional nbunch (container of nodes) only out edges</span>
<span class="sd">        adjacent to nodes in nbunch will be returned.</span>

<span class="sd">        Note: modifying the graph structure while iterating over</span>
<span class="sd">        edges may produce unpredictable results.  Use in_edges()</span>
<span class="sd">        as an alternative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nbunch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># all nodes</span>
            <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">nh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">eh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="n">eh</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">e</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">eh</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="k">return</span>
        <span class="k">elif</span> <span class="n">nbunch</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>  <span class="c1"># if nbunch is a single node</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="p">)</span>
            <span class="n">nh</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">handle</span>
            <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">eh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="n">eh</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">e</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">eh</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if nbunch is a sequence of nodes</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bunch</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nbunch</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;nbunch is not a node or a sequence of nodes.&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nbunch</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nh</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">handle</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">eh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">e</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="n">eh</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">e</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">eh</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                        <span class="k">break</span></div>

<div class="viewcode-block" id="AGraph.edges_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.edges_iter">[docs]</a>    <span class="k">def</span> <span class="nf">edges_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return iterator over edges in the graph.</span>

<span class="sd">        If the optional nbunch (container of nodes) only edges</span>
<span class="sd">        adjacent to nodes in nbunch will be returned.</span>

<span class="sd">        Note: modifying the graph structure while iterating over</span>
<span class="sd">        edges may produce unpredictable results.  Use edges()</span>
<span class="sd">        as an alternative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nbunch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># all nodes</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges_iter</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">e</span>
        <span class="k">elif</span> <span class="n">nbunch</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>  <span class="c1"># only one node</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">e</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_edges_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="p">(</span><span class="n">nbunch</span><span class="p">,</span> <span class="n">nbunch</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">e</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># a group of nodes</span>
            <span class="n">used</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">e</span>
                <span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_edges_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">e</span></div>

    <span class="n">iterinedges</span> <span class="o">=</span> <span class="n">in_edges_iter</span>

    <span class="n">iteredges</span> <span class="o">=</span> <span class="n">edges_iter</span>

<div class="viewcode-block" id="AGraph.out_edges"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.out_edges">[docs]</a>    <span class="k">def</span> <span class="nf">out_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return list of out edges in the graph.</span>

<span class="sd">        If the optional nbunch (container of nodes) only out edges</span>
<span class="sd">        adjacent to nodes in nbunch will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_edges_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="o">=</span><span class="n">nbunch</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">))</span></div>

<div class="viewcode-block" id="AGraph.in_edges"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.in_edges">[docs]</a>    <span class="k">def</span> <span class="nf">in_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return list of in edges in the graph.</span>
<span class="sd">        If the optional nbunch (container of nodes) only in edges</span>
<span class="sd">        adjacent to nodes in nbunch will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_edges_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="o">=</span><span class="n">nbunch</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">))</span></div>

<div class="viewcode-block" id="AGraph.predecessors_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.predecessors_iter">[docs]</a>    <span class="k">def</span> <span class="nf">predecessors_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return iterator over predecessor nodes of n.</span>

<span class="sd">        Note: modifying the graph structure while iterating over</span>
<span class="sd">        node predecessors may produce unpredictable results.  Use</span>
<span class="sd">        predecessors() as an alternative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">nh</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">handle</span>
        <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">eh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="n">eh</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">eh</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span></div>

    <span class="n">iterpred</span> <span class="o">=</span> <span class="n">predecessors_iter</span>

<div class="viewcode-block" id="AGraph.successors_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.successors_iter">[docs]</a>    <span class="k">def</span> <span class="nf">successors_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return iterator over successor nodes of n.</span>

<span class="sd">        Note: modifying the graph structure while iterating over</span>
<span class="sd">        node successors may produce unpredictable results.  Use</span>
<span class="sd">        successors() as an alternative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">nh</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">handle</span>
        <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">eh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="n">eh</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">eh</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span></div>

    <span class="n">itersucc</span> <span class="o">=</span> <span class="n">successors_iter</span>

<div class="viewcode-block" id="AGraph.successors"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.successors">[docs]</a>    <span class="k">def</span> <span class="nf">successors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return list of successor nodes of n.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">successors_iter</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="AGraph.predecessors"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.predecessors">[docs]</a>    <span class="k">def</span> <span class="nf">predecessors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return list of predecessor nodes of n.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predecessors_iter</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>

    <span class="c1"># digraph definitions</span>
    <span class="n">out_neighbors</span> <span class="o">=</span> <span class="n">successors</span>
    <span class="n">in_neighbors</span> <span class="o">=</span> <span class="n">predecessors</span>

<div class="viewcode-block" id="AGraph.degree_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.degree_iter">[docs]</a>    <span class="k">def</span> <span class="nf">degree_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">indeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outdeg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an iterator over the degree of the nodes given in</span>
<span class="sd">        nbunch container.</span>

<span class="sd">        Returns pairs of (node,degree).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_nbunch</span><span class="p">(</span><span class="n">nbunch</span><span class="p">):</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">gv</span><span class="o">.</span><span class="n">agdegree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">indeg</span><span class="p">,</span> <span class="n">outdeg</span><span class="p">))</span></div>

<div class="viewcode-block" id="AGraph.in_degree_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.in_degree_iter">[docs]</a>    <span class="k">def</span> <span class="nf">in_degree_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an iterator over the in-degree of the nodes given in</span>
<span class="sd">        nbunch container.</span>

<span class="sd">        Returns pairs of (node,degree).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">degree_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">,</span> <span class="n">indeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outdeg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.out_degree_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.out_degree_iter">[docs]</a>    <span class="k">def</span> <span class="nf">out_degree_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an iterator over the out-degree of the nodes given in</span>
<span class="sd">        nbunch container.</span>

<span class="sd">        Returns pairs of (node,degree).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">degree_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">,</span> <span class="n">indeg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">outdeg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

    <span class="n">iteroutdegree</span> <span class="o">=</span> <span class="n">out_degree_iter</span>
    <span class="n">iterindegree</span> <span class="o">=</span> <span class="n">in_degree_iter</span>

<div class="viewcode-block" id="AGraph.out_degree"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.out_degree">[docs]</a>    <span class="k">def</span> <span class="nf">out_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the out-degree of nodes given in nbunch container.</span>

<span class="sd">        Using optional with_labels=True returns a dictionary</span>
<span class="sd">        keyed by node with value set to the degree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">with_labels</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_degree_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_degree_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">nbunch</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">dlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">dlist</span></div>

<div class="viewcode-block" id="AGraph.in_degree"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.in_degree">[docs]</a>    <span class="k">def</span> <span class="nf">in_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the in-degree of nodes given in nbunch container.</span>

<span class="sd">        Using optional with_labels=True returns a dictionary</span>
<span class="sd">        keyed by node with value set to the degree.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">with_labels</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_degree_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_degree_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">nbunch</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">dlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">dlist</span></div>

<div class="viewcode-block" id="AGraph.reverse"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.reverse">[docs]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return copy of directed graph with edge directions reversed.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">:</span>
            <span class="c1"># new empty DiGraph</span>
            <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">H</span><span class="o">.</span><span class="n">graph_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">)</span>
            <span class="n">H</span><span class="o">.</span><span class="n">node_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_attr</span><span class="p">)</span>
            <span class="n">H</span><span class="o">.</span><span class="n">edge_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_attr</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
                <span class="n">H</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">new_n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                <span class="n">new_n</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
                <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">e</span>
                <span class="n">H</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
                <span class="n">uv</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
                <span class="n">uv</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">H</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="AGraph.degree"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.degree">[docs]</a>    <span class="k">def</span> <span class="nf">degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the degree of nodes given in nbunch container.</span>

<span class="sd">        Using optional with_labels=True returns a dictionary</span>
<span class="sd">        keyed by node with value set to the degree.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">with_labels</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">degree_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">degree_iter</span><span class="p">(</span><span class="n">nbunch</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">nbunch</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">dlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">dlist</span></div>

    <span class="n">iterdegree</span> <span class="o">=</span> <span class="n">degree_iter</span>

<div class="viewcode-block" id="AGraph.number_of_edges"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.number_of_edges">[docs]</a>    <span class="k">def</span> <span class="nf">number_of_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of edges in the graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnedges</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.clear"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove all nodes, edges, and attributes from the graph.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_nodes_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
        <span class="c1"># now &quot;close&quot; existing graph and create a new graph</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnameof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="n">strict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span>
        <span class="n">directed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close_handle</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agraphnew</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">strict</span><span class="p">,</span> <span class="n">directed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owns_handle</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_handle_references</span><span class="p">()</span></div>

<div class="viewcode-block" id="AGraph.close"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close_handle</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_close_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># may be useful to clean up graphviz data</span>
        <span class="c1"># this should completely remove all of the existing graphviz data</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owns_handle</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">gv</span><span class="o">.</span><span class="n">agclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_owns_handle</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="AGraph.copy"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a copy of the graph.</span>

<span class="sd">        Notes</span>
<span class="sd">        =====</span>
<span class="sd">        Versions &lt;=1.6 made a copy by writing and the reading a dot string.</span>
<span class="sd">        This version loads a new graph with nodes, edges and attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_directed</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="n">G</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span>
            <span class="n">G</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>
        <span class="n">G</span><span class="o">.</span><span class="n">graph_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">)</span>
        <span class="n">G</span><span class="o">.</span><span class="n">node_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_attr</span><span class="p">)</span>
        <span class="n">G</span><span class="o">.</span><span class="n">edge_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_attr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">G</span></div>

<div class="viewcode-block" id="AGraph.add_path"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.add_path">[docs]</a>    <span class="k">def</span> <span class="nf">add_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the path of nodes given in nlist.&quot;&quot;&quot;</span>
        <span class="n">fromv</span> <span class="o">=</span> <span class="n">nlist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">nlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tov</span> <span class="o">=</span> <span class="n">nlist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fromv</span><span class="p">,</span> <span class="n">tov</span><span class="p">)</span>
            <span class="n">fromv</span> <span class="o">=</span> <span class="n">tov</span></div>

<div class="viewcode-block" id="AGraph.add_cycle"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.add_cycle">[docs]</a>    <span class="k">def</span> <span class="nf">add_cycle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the cycle of nodes given in nlist.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_path</span><span class="p">(</span><span class="n">nlist</span> <span class="o">+</span> <span class="p">[</span><span class="n">nlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span></div>

    <span class="k">def</span> <span class="nf">_prepare_nbunch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># private function to build bunch from nbunch</span>
        <span class="k">if</span> <span class="n">nbunch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># include all nodes via iterator</span>
            <span class="n">bunch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_iter</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">nbunch</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>  <span class="c1"># if nbunch is a single node</span>
            <span class="n">bunch</span> <span class="o">=</span> <span class="p">[</span><span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if nbunch is a sequence of nodes</span>
            <span class="k">try</span><span class="p">:</span>  <span class="c1"># capture error for nonsequence/iterator entries.</span>
                <span class="n">bunch</span> <span class="o">=</span> <span class="p">[</span><span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nbunch</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
                <span class="c1"># bunch=(n for n in nbunch if n in self) # need python 2.4</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;nbunch is not a node or a sequence of nodes.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bunch</span>

<div class="viewcode-block" id="AGraph.add_subgraph"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.add_subgraph">[docs]</a>    <span class="k">def</span> <span class="nf">add_subgraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return subgraph induced by nodes in nbunch.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agsubg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">_Action</span><span class="o">.</span><span class="n">create</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Subgraph name must be a string: </span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">,</span> <span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">nbunch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H</span>
        <span class="c1"># add induced subgraph on nodes in nbunch</span>
        <span class="n">bunch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_nbunch</span><span class="p">(</span><span class="n">nbunch</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">bunch</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agsubnode</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">_Action</span><span class="o">.</span><span class="n">create</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">H</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">H</span><span class="p">:</span>
                <span class="n">edge</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agsubedge</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">edge</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">_Action</span><span class="o">.</span><span class="n">create</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">H</span></div>

<div class="viewcode-block" id="AGraph.remove_subgraph"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.remove_subgraph">[docs]</a>    <span class="k">def</span> <span class="nf">remove_subgraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove subgraph with given name.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agsubg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span> <span class="n">_Action</span><span class="o">.</span><span class="n">find</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subgraph name must be a string: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">handle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subgraph </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> not in graph.&quot;</span><span class="p">)</span>
        <span class="n">gv</span><span class="o">.</span><span class="n">agdelsubg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">handle</span><span class="p">)</span></div>

    <span class="n">delete_subgraph</span> <span class="o">=</span> <span class="n">remove_subgraph</span>

    <span class="n">subgraph</span> <span class="o">=</span> <span class="n">add_subgraph</span>

<div class="viewcode-block" id="AGraph.subgraph_parent"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.subgraph_parent">[docs]</a>    <span class="k">def</span> <span class="nf">subgraph_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return parent graph of subgraph or None if graph is root graph.&quot;&quot;&quot;</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agparent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">handle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">,</span> <span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">H</span></div>

<div class="viewcode-block" id="AGraph.subgraph_root"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.subgraph_root">[docs]</a>    <span class="k">def</span> <span class="nf">subgraph_root</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nbunch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return root graph of subgraph or None if graph is root graph.&quot;&quot;&quot;</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agroot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">handle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">,</span> <span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">H</span></div>

<div class="viewcode-block" id="AGraph.get_subgraph"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.get_subgraph">[docs]</a>    <span class="k">def</span> <span class="nf">get_subgraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return existing subgraph with specified name or None if it</span>
<span class="sd">        doesn&#39;t exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agsubg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span> <span class="n">_Action</span><span class="o">.</span><span class="n">find</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subgraph name must be a string: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">handle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">,</span> <span class="n">handle</span><span class="o">=</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">H</span></div>

<div class="viewcode-block" id="AGraph.subgraphs_iter"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.subgraphs_iter">[docs]</a>    <span class="k">def</span> <span class="nf">subgraphs_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Iterator over subgraphs.&quot;&quot;&quot;</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agfstsubg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">handle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">,</span> <span class="n">handle</span><span class="o">=</span><span class="n">handle</span>
            <span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtsubg</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span></div>

<div class="viewcode-block" id="AGraph.subgraphs"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.subgraphs">[docs]</a>    <span class="k">def</span> <span class="nf">subgraphs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of all subgraphs in the graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subgraphs_iter</span><span class="p">())</span></div>

    <span class="c1"># directed, undirected tests and conversions</span>

<div class="viewcode-block" id="AGraph.is_strict"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.is_strict">[docs]</a>    <span class="k">def</span> <span class="nf">is_strict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if graph is strict or False if not.</span>

<span class="sd">        Strict graphs do not allow parallel edges or self loops.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">gv</span><span class="o">.</span><span class="n">agisstrict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    <span class="n">strict</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">is_strict</span><span class="p">)</span>

<div class="viewcode-block" id="AGraph.is_directed"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.is_directed">[docs]</a>    <span class="k">def</span> <span class="nf">is_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if graph is directed or False if not.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">gv</span><span class="o">.</span><span class="n">agisdirected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    <span class="n">directed</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">is_directed</span><span class="p">)</span>

<div class="viewcode-block" id="AGraph.is_undirected"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.is_undirected">[docs]</a>    <span class="k">def</span> <span class="nf">is_undirected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if graph is undirected or False if not.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">gv</span><span class="o">.</span><span class="n">agisundirected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="AGraph.to_undirected"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.to_undirected">[docs]</a>    <span class="k">def</span> <span class="nf">to_undirected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return undirected copy of graph.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">U</span> <span class="o">=</span> <span class="n">AGraph</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">graph_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">node_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_attr</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">edge_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_attr</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
                <span class="n">U</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">new_n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                <span class="n">new_n</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
                <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">e</span>
                <span class="n">U</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="n">uv</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="n">uv</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">U</span></div>

<div class="viewcode-block" id="AGraph.to_directed"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.to_directed">[docs]</a>    <span class="k">def</span> <span class="nf">to_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return directed copy of graph.</span>

<span class="sd">        Each undirected edge u-v is represented as two directed</span>
<span class="sd">        edges u-&gt;v and v-&gt;u.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">:</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">AGraph</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">D</span><span class="o">.</span><span class="n">graph_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">)</span>
            <span class="n">D</span><span class="o">.</span><span class="n">node_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_attr</span><span class="p">)</span>
            <span class="n">D</span><span class="o">.</span><span class="n">edge_attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_attr</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
                <span class="n">D</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">new_n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                <span class="n">new_n</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
                <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">e</span>
                <span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
                <span class="n">uv</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="n">vu</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
                <span class="n">uv</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>
                <span class="n">uv</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>
                <span class="n">vu</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">D</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>

    <span class="c1"># io</span>
<div class="viewcode-block" id="AGraph.read"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read graph from dot format file on path.</span>

<span class="sd">        path can be a file name or file handle</span>

<span class="sd">        use::</span>

<span class="sd">           G.read(&#39;file.dot&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_fh</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_close_handle</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agread</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DotError</span><span class="p">(</span><span class="s2">&quot;Invalid Input&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_owns_handle</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_handle_references</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IO error reading file&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.write"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write graph in dot format to file on path.</span>

<span class="sd">        path can be a file name or file handle</span>

<span class="sd">        use::</span>

<span class="sd">           G.write(&#39;file.dot&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
        <span class="n">fh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_fh</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="c1"># NOTE: TemporaryFile objects are not instances of IOBase on windows.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">_TemporaryFileWrapper</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fh</span><span class="si">}</span><span class="s2"> is not a file handle&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">gv</span><span class="o">.</span><span class="n">agwrite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">fh</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IO error writing file&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">):</span>
                <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="AGraph.string_nop"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.string_nop">[docs]</a>    <span class="k">def</span> <span class="nf">string_nop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a string (unicode) representation of graph in dot format.&quot;&quot;&quot;</span>
        <span class="c1"># this will fail for graphviz-2.8 because of a broken nop</span>
        <span class="c1"># so use tempfile version below</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;dot&quot;</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="s2">&quot;nop&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.to_string"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a string representation of graph in dot format.</span>

<span class="sd">        `to_string()` uses &quot;agwrite&quot; to produce &quot;dot&quot; format w/o rendering.</span>
<span class="sd">        The function `string_nop()` layouts with &quot;nop&quot; and renders to &quot;dot&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fh</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryFile</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.string"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.string">[docs]</a>    <span class="k">def</span> <span class="nf">string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a string (unicode) representation of graph in dot format.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span></div>
        <span class="c1"># return self.string_nop()</span>

<div class="viewcode-block" id="AGraph.from_string"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.from_string">[docs]</a>    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load a graph from a string in dot format.</span>

<span class="sd">        Overwrites any existing graph.</span>

<span class="sd">        To make a new graph from a string use</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; s = &quot;digraph {1 -&gt; 2}&quot;</span>
<span class="sd">        &gt;&gt;&gt; A = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; t = A.from_string(s)</span>
<span class="sd">        &gt;&gt;&gt; A = pgv.AGraph(string=s)  # specify s is a string</span>
<span class="sd">        &gt;&gt;&gt; A = pgv.AGraph(s)  # s assumed to be a string during initialization</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># allow either unicode or encoded string</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">UnicodeEncodeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryFile</span>

        <span class="n">fh</span> <span class="o">=</span> <span class="n">TemporaryFile</span><span class="p">()</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">))</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="k">def</span> <span class="nf">_get_prog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prog</span><span class="p">):</span>
        <span class="c1"># private: get path of graphviz program</span>
        <span class="n">progs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;neato&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dot&quot;</span><span class="p">,</span>
            <span class="s2">&quot;twopi&quot;</span><span class="p">,</span>
            <span class="s2">&quot;circo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fdp&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nop&quot;</span><span class="p">,</span>
            <span class="s2">&quot;osage&quot;</span><span class="p">,</span>
            <span class="s2">&quot;patchwork&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;acyclic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gvpr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gvcolor&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ccomps&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sccmap&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tred&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sfdp&quot;</span><span class="p">,</span>
            <span class="s2">&quot;unflatten&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">prog</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">progs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Program </span><span class="si">{</span><span class="n">prog</span><span class="si">}</span><span class="s2"> is not one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">progs</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>  <span class="c1"># user must pick one of the graphviz programs...</span>
            <span class="n">runprog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_which</span><span class="p">(</span><span class="n">prog</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Program </span><span class="si">{</span><span class="n">prog</span><span class="si">}</span><span class="s2"> not found in path.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">runprog</span>

    <span class="k">def</span> <span class="nf">_run_prog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="s2">&quot;nop&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply graphviz program to graph and return the result as a string.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; A = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; s = A._run_prog()  # doctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; s = A._run_prog(prog=&quot;acyclic&quot;)  # doctest: +SKIP</span>

<span class="sd">        Use keyword args to add additional arguments to graphviz programs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">runprog</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_prog</span><span class="p">(</span><span class="n">prog</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">runprog</span><span class="p">,</span> <span class="n">args</span><span class="p">])</span>
        <span class="n">dotargs</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="n">dotargs</span><span class="p">,</span>
            <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">close_fds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">child_stdin</span><span class="p">,</span> <span class="n">child_stdout</span><span class="p">,</span> <span class="n">child_stderr</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">stdin</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="c1"># Use threading to avoid blocking</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">threads</span> <span class="o">=</span> <span class="p">[</span><span class="n">PipeReader</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">child_stdout</span><span class="p">),</span> <span class="n">PipeReader</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="n">child_stderr</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">child_stdin</span><span class="p">)</span>
        <span class="n">child_stdin</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="n">p</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span> <span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<div class="viewcode-block" id="AGraph.unflatten"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.unflatten">[docs]</a>    <span class="k">def</span> <span class="nf">unflatten</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adjust directed graphs to improve layout aspect ratio.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; A = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; A_unflattened = A.unflatten(&quot;-f -l 3&quot;)</span>
<span class="sd">        &gt;&gt;&gt; A.unflatten(&quot;-f -l 1&quot;).layout()</span>

<span class="sd">        Use keyword args to add additional arguments to graphviz programs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_prog</span><span class="p">(</span><span class="s2">&quot;unflatten&quot;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="AGraph.tred"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.tred">[docs]</a>    <span class="k">def</span> <span class="nf">tred</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transitive reduction of graph.  Modifies existing graph.</span>

<span class="sd">        To create a new graph use</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; A = pgv.AGraph(directed=True)</span>
<span class="sd">        &gt;&gt;&gt; B = A.tred(copy=True)  # doctest: +SKIP</span>

<span class="sd">        See the graphviz &quot;tred&quot; program for details of the algorithm.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;tred requires a directed graph&quot;</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_prog</span><span class="p">(</span><span class="s2">&quot;tred&quot;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.acyclic"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.acyclic">[docs]</a>    <span class="k">def</span> <span class="nf">acyclic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reverse sufficient edges in digraph to make graph acyclic.</span>
<span class="sd">        Modifies existing graph.</span>

<span class="sd">        To create a new graph use</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; A = pgv.AGraph(directed=True)</span>
<span class="sd">        &gt;&gt;&gt; B = A.acyclic(copy=True)  # doctest: +SKIP</span>

<span class="sd">        See the graphviz &quot;acyclic&quot; program for details of the algorithm.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;acyclic requires a directed graph&quot;</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_prog</span><span class="p">(</span><span class="s2">&quot;acyclic&quot;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="AGraph.layout"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.layout">[docs]</a>    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="s2">&quot;neato&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign positions to nodes in graph.</span>

<span class="sd">        Optional prog=[&#39;neato&#39;|&#39;dot&#39;|&#39;twopi&#39;|&#39;circo&#39;|&#39;fdp&#39;|&#39;nop&#39;]</span>
<span class="sd">        will use specified graphviz layout method.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; A = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; A.add_edge(1, 2)</span>
<span class="sd">        &gt;&gt;&gt; A.layout()</span>
<span class="sd">        &gt;&gt;&gt; A.layout(prog=&quot;neato&quot;, args=&quot;-Nshape=box -Efontsize=8&quot;)</span>

<span class="sd">        Use keyword args to add additional arguments to graphviz programs.</span>

<span class="sd">        The layout might take a long time on large graphs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output_fmt</span> <span class="o">=</span> <span class="s2">&quot;dot&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_prog</span><span class="p">(</span><span class="n">prog</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">args</span><span class="p">,</span> <span class="s2">&quot;-T&quot;</span><span class="p">,</span> <span class="n">output_fmt</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_layout</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>

    <span class="k">def</span> <span class="nf">_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="s2">&quot;neato&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign positions to nodes in graph.</span>

<span class="sd">        .. caution:: EXPERIMENTAL</span>

<span class="sd">        This version of the layout command uses libgvc for layout instead</span>
<span class="sd">        of command line GraphViz tools like in versions &lt;1.6 and the default.</span>

<span class="sd">        Optional prog=[&#39;neato&#39;|&#39;dot&#39;|&#39;twopi&#39;|&#39;circo&#39;|&#39;fdp&#39;|&#39;nop&#39;]</span>
<span class="sd">        will use specified graphviz layout method.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; A = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; A.add_edge(1, 2)</span>
<span class="sd">        &gt;&gt;&gt; A.layout()</span>
<span class="sd">        &gt;&gt;&gt; A.layout(prog=&quot;neato&quot;, args=&quot;-Nshape=box -Efontsize=8&quot;)</span>

<span class="sd">        Use keyword args to add additional arguments to graphviz programs.</span>

<span class="sd">        The layout might take a long time on large graphs.</span>

<span class="sd">        Note: attaching positions in the AGraph usually doesn&#39;t affect the</span>
<span class="sd">        next rendering. The positions are recomputed. But if you use prog=&quot;nop&quot;</span>
<span class="sd">        when rendering, it will take node positions from the AGraph attributes.</span>
<span class="sd">        If you use prog=&quot;nop2&quot; it will take node and edge positions from the</span>
<span class="sd">        AGraph when rendering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">prog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manually_parse_args</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">prog</span><span class="p">)</span>

        <span class="c1"># convert input strings to type bytes (encode it)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prog</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">prog</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>

        <span class="n">gvc</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvContext</span><span class="p">()</span>
        <span class="n">gv</span><span class="o">.</span><span class="n">gvLayout</span><span class="p">(</span><span class="n">gvc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">prog</span><span class="p">)</span>
        <span class="n">gv</span><span class="o">.</span><span class="n">gvRender</span><span class="p">(</span><span class="n">gvc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;dot&quot;</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">gv</span><span class="o">.</span><span class="n">gvFreeLayout</span><span class="p">(</span><span class="n">gvc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="n">gv</span><span class="o">.</span><span class="n">gvFreeContext</span><span class="p">(</span><span class="n">gvc</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">has_layout</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span>

<div class="viewcode-block" id="AGraph.draw"><a class="viewcode-back" href="../../reference/agraph.html#pygraphviz.AGraph.draw">[docs]</a>    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Output graph to path in specified format.</span>

<span class="sd">        An attempt will be made to guess the output format based on the file</span>
<span class="sd">        extension of `path`.  If that fails, then the `format` parameter will</span>
<span class="sd">        be used.</span>

<span class="sd">        Note, if `path` is a file object returned by a call to os.fdopen(),</span>
<span class="sd">        then the method for discovering the format will not work.  In such</span>
<span class="sd">        cases, one should explicitly set the `format` parameter; otherwise, it</span>
<span class="sd">        will default to &#39;dot&#39;.</span>

<span class="sd">        If path is None, the result is returned as a Bytes object.</span>

<span class="sd">        Formats (not all may be available on every system depending on</span>
<span class="sd">        how Graphviz was built)</span>

<span class="sd">            &#39;canon&#39;, &#39;cmap&#39;, &#39;cmapx&#39;, &#39;cmapx_np&#39;, &#39;dia&#39;, &#39;dot&#39;,</span>
<span class="sd">            &#39;fig&#39;, &#39;gd&#39;, &#39;gd2&#39;, &#39;gif&#39;, &#39;hpgl&#39;, &#39;imap&#39;, &#39;imap_np&#39;,</span>
<span class="sd">            &#39;ismap&#39;, &#39;jpe&#39;, &#39;jpeg&#39;, &#39;jpg&#39;, &#39;mif&#39;, &#39;mp&#39;, &#39;pcl&#39;, &#39;pdf&#39;,</span>
<span class="sd">            &#39;pic&#39;, &#39;plain&#39;, &#39;plain-ext&#39;, &#39;png&#39;, &#39;ps&#39;, &#39;ps2&#39;, &#39;svg&#39;,</span>
<span class="sd">            &#39;svgz&#39;, &#39;vml&#39;, &#39;vmlz&#39;, &#39;vrml&#39;, &#39;vtx&#39;, &#39;wbmp&#39;, &#39;xdot&#39;, &#39;xlib&#39;</span>


<span class="sd">        If prog is not specified and the graph has positions</span>
<span class="sd">        (see layout()) then no additional graph positioning will</span>
<span class="sd">        be performed.</span>

<span class="sd">        Optional prog=[&#39;neato&#39;|&#39;dot&#39;|&#39;twopi&#39;|&#39;circo&#39;|&#39;fdp&#39;|&#39;nop&#39;]</span>
<span class="sd">        will use specified graphviz layout method.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_edges_from([(0, 1), (1, 2), (2, 0), (2, 3)])</span>
<span class="sd">        &gt;&gt;&gt; G.layout()</span>

<span class="sd">        # use current node positions, output pdf in &#39;file.pdf&#39;</span>
<span class="sd">        &gt;&gt;&gt; G.draw(&quot;file.pdf&quot;)</span>

<span class="sd">        # use dot to position, output png in &#39;file&#39;</span>
<span class="sd">        &gt;&gt;&gt; G.draw(&quot;file&quot;, format=&quot;png&quot;, prog=&quot;dot&quot;)</span>

<span class="sd">        # use keyword &#39;args&#39; to pass additional arguments to graphviz</span>
<span class="sd">        &gt;&gt;&gt; G.draw(&quot;test.pdf&quot;, prog=&quot;twopi&quot;, args=&quot;-Gepsilon=1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; G.draw(&quot;test2.pdf&quot;, args=&quot;-Nshape=box -Edir=forward -Ecolor=red &quot;)</span>

<span class="sd">        The layout might take a long time on large graphs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># try to guess format from extension</span>
        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">path</span>
            <span class="c1"># in case we got a file handle get its name instead</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;dot&quot;</span>

        <span class="k">if</span> <span class="n">prog</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_layout</span><span class="p">:</span>
                <span class="n">prog</span> <span class="o">=</span> <span class="s2">&quot;neato&quot;</span>
                <span class="n">args</span> <span class="o">+=</span> <span class="s2">&quot;-n2&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                    <span class="s2">&quot;Graph has no layout information, see layout() or specify prog=</span><span class="si">%s</span><span class="s2">.&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;neato&quot;</span><span class="p">,</span> <span class="s2">&quot;dot&quot;</span><span class="p">,</span> <span class="s2">&quot;twopi&quot;</span><span class="p">,</span> <span class="s2">&quot;circo&quot;</span><span class="p">,</span> <span class="s2">&quot;fdp&quot;</span><span class="p">,</span> <span class="s2">&quot;nop&quot;</span><span class="p">]))</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s2">&quot;Warning: graph has </span><span class="si">%s</span><span class="s2"> nodes...layout may take a long time.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">prog</span> <span class="o">==</span> <span class="s2">&quot;nop&quot;</span><span class="p">:</span>  <span class="c1"># nop takes no switches</span>
            <span class="n">args</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">args</span><span class="p">,</span> <span class="s2">&quot;-T&quot;</span> <span class="o">+</span> <span class="nb">format</span><span class="p">])</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_prog</span><span class="p">(</span><span class="n">prog</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_fh</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w+b&quot;</span><span class="p">)</span>
            <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">d</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">d</span></div>

    <span class="k">def</span> <span class="nf">_draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Output graph to path in specified format.</span>

<span class="sd">        .. caution:: EXPERIMENTAL</span>

<span class="sd">        This version of the draw command uses libgvc for drawing instead</span>
<span class="sd">        of command line GraphViz tools like in versions &lt;1.6 and the default.</span>

<span class="sd">        An attempt will be made to guess the output format based on the file</span>
<span class="sd">        extension of `path`.  If that fails, then the `format` parameter will</span>
<span class="sd">        be used.</span>

<span class="sd">        Note, if `path` is a file object returned by a call to os.fdopen(),</span>
<span class="sd">        then the method for discovering the format will not work.  In such</span>
<span class="sd">        cases, one should explicitly set the `format` parameter; otherwise, it</span>
<span class="sd">        will default to &#39;dot&#39;.</span>

<span class="sd">        If path is None, the result is returned as a Bytes object.</span>

<span class="sd">        Formats (not all may be available on every system depending on</span>
<span class="sd">        how Graphviz was built)</span>

<span class="sd">            &#39;canon&#39;, &#39;cmap&#39;, &#39;cmapx&#39;, &#39;cmapx_np&#39;, &#39;dia&#39;, &#39;dot&#39;,</span>
<span class="sd">            &#39;fig&#39;, &#39;gd&#39;, &#39;gd2&#39;, &#39;gif&#39;, &#39;hpgl&#39;, &#39;imap&#39;, &#39;imap_np&#39;,</span>
<span class="sd">            &#39;ismap&#39;, &#39;jpe&#39;, &#39;jpeg&#39;, &#39;jpg&#39;, &#39;mif&#39;, &#39;mp&#39;, &#39;pcl&#39;, &#39;pdf&#39;,</span>
<span class="sd">            &#39;pic&#39;, &#39;plain&#39;, &#39;plain-ext&#39;, &#39;png&#39;, &#39;ps&#39;, &#39;ps2&#39;, &#39;svg&#39;,</span>
<span class="sd">            &#39;svgz&#39;, &#39;vml&#39;, &#39;vmlz&#39;, &#39;vrml&#39;, &#39;vtx&#39;, &#39;wbmp&#39;, &#39;xdot&#39;, &#39;xlib&#39;</span>


<span class="sd">        If prog is not specified and the graph has positions</span>
<span class="sd">        (see layout()) then no additional graph positioning will</span>
<span class="sd">        be performed.</span>

<span class="sd">        Optional prog=[&#39;neato&#39;|&#39;dot&#39;|&#39;twopi&#39;|&#39;circo&#39;|&#39;fdp&#39;|&#39;nop&#39;]</span>
<span class="sd">        will use specified graphviz layout method.</span>

<span class="sd">        &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">        &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">        &gt;&gt;&gt; G.add_edges_from([(0, 1), (1, 2), (2, 0), (2, 3)])</span>
<span class="sd">        &gt;&gt;&gt; G.layout()</span>

<span class="sd">        # use current node positions, output pdf in &#39;file.pdf&#39;</span>
<span class="sd">        &gt;&gt;&gt; G.draw(&quot;file.pdf&quot;)</span>

<span class="sd">        # use dot to position, output png in &#39;file&#39;</span>
<span class="sd">        &gt;&gt;&gt; G.draw(&quot;file&quot;, format=&quot;png&quot;, prog=&quot;dot&quot;)</span>

<span class="sd">        # use keyword &#39;args&#39; to pass additional arguments to graphviz</span>
<span class="sd">        &gt;&gt;&gt; G.draw(&quot;test.pdf&quot;, prog=&quot;twopi&quot;, args=&quot;-Gepsilon=1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; G.draw(&quot;test2.pdf&quot;, args=&quot;-Nshape=box -Edir=forward -Ecolor=red &quot;)</span>

<span class="sd">        The layout might take a long time on large graphs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># try to guess format from extension</span>
        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">path</span>
            <span class="c1"># in case we got a file handle get its name instead</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;dot&quot;</span>

        <span class="k">if</span> <span class="n">prog</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_layout</span><span class="p">:</span>
                <span class="n">prog</span> <span class="o">=</span> <span class="s2">&quot;neato&quot;</span>
                <span class="n">args</span> <span class="o">+=</span> <span class="s2">&quot; -n2&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                    <span class="sd">&quot;&quot;&quot;Graph has no layout information, see layout() or specify prog=%s.&quot;&quot;&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;neato&quot;</span><span class="p">,</span> <span class="s2">&quot;dot&quot;</span><span class="p">,</span> <span class="s2">&quot;twopi&quot;</span><span class="p">,</span> <span class="s2">&quot;circo&quot;</span><span class="p">,</span> <span class="s2">&quot;fdp&quot;</span><span class="p">,</span> <span class="s2">&quot;nop&quot;</span><span class="p">]))</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s2">&quot;Warning: graph has </span><span class="si">%s</span><span class="s2"> nodes...layout may take a long time.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span>
                <span class="p">)</span>

        <span class="c1"># process args</span>
        <span class="nb">format</span><span class="p">,</span> <span class="n">prog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manually_parse_args</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="n">prog</span><span class="p">)</span>

        <span class="c1"># convert input strings to type bytes (encode it)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">format</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prog</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">prog</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>

        <span class="c1"># Start the drawing</span>
        <span class="n">gvc</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvContext</span><span class="p">()</span>
        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span>

        <span class="c1"># Layout</span>
        <span class="n">err</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvLayout</span><span class="p">(</span><span class="n">gvc</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">prog</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Graphviz raised a layout error.&quot;</span><span class="p">)</span>
            <span class="n">prog</span> <span class="o">=</span> <span class="n">prog</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t find prog=</span><span class="si">{</span><span class="n">prog</span><span class="si">}</span><span class="s2"> in this graphviz installation&quot;</span><span class="p">)</span>

        <span class="c1"># Render</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvRenderData</span><span class="p">(</span><span class="n">gvc</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Graphviz Error creating dot representation:</span><span class="si">{</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">err</span><span class="p">,</span> <span class="n">dot_string</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">out</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">dot_string</span><span class="p">)</span> <span class="o">==</span> <span class="n">length</span>
            <span class="n">gv</span><span class="o">.</span><span class="n">gvFreeLayout</span><span class="p">(</span><span class="n">gvc</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
            <span class="n">gv</span><span class="o">.</span><span class="n">gvFreeContext</span><span class="p">(</span><span class="n">gvc</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">dot_string</span>

        <span class="c1"># path is string holding the filename, a file handle, or pathlib.Path</span>
        <span class="n">fh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_fh</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
        <span class="n">err</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">gvRender</span><span class="p">(</span><span class="n">gvc</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="n">fh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Graphviz raised a render error. Maybe bad format?&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">gv</span><span class="o">.</span><span class="n">gvFreeLayout</span><span class="p">(</span><span class="n">gvc</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
        <span class="n">gv</span><span class="o">.</span><span class="n">gvFreeContext</span><span class="p">(</span><span class="n">gvc</span><span class="p">)</span>

    <span class="c1"># some private helper functions</span>

    <span class="k">def</span> <span class="nf">_manually_parse_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Experimental code to parse args relevant for libgvc drawing and layout&quot;&quot;&quot;</span>
        <span class="n">arg_list</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">arg_list</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">arg</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-T&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">format</span> <span class="ow">and</span> <span class="nb">format</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;format doesnt match in args and format inputs&quot;</span><span class="p">)</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">if</span> <span class="n">arg</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-K&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prog</span> <span class="ow">and</span> <span class="n">prog</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">prog</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="c1"># raise ValueError(&quot;prog doesnt match in args and prog inputs&quot;)</span>
                <span class="n">prog</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">if</span> <span class="n">arg</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-G&quot;</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">if</span> <span class="n">arg</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-N&quot;</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node_attr</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">if</span> <span class="n">arg</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-E&quot;</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edge_attr</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="nb">format</span><span class="p">,</span> <span class="n">prog</span>

    <span class="k">def</span> <span class="nf">_get_fh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a file handle for given path.</span>

<span class="sd">        Path can be a string, pathlib.Path, or a file handle.</span>
<span class="sd">        Attempt to uncompress/compress files ending in &#39;.gz&#39; and &#39;.bz2&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gz&quot;</span><span class="p">):</span>
                <span class="c1"># import gzip</span>
                <span class="c1"># fh = gzip.open(path,mode=mode)  # doesn&#39;t return real fh</span>
                <span class="n">fh</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s2">&quot;gzcat &quot;</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>  <span class="c1"># probably not portable</span>
            <span class="k">elif</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.bz2&quot;</span><span class="p">):</span>
                <span class="c1"># import bz2</span>
                <span class="c1"># fh = bz2.BZ2File(path,mode=mode) # doesn&#39;t return real fh</span>
                <span class="n">fh</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s2">&quot;bzcat &quot;</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>  <span class="c1"># probably not portable</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">):</span>
            <span class="c1"># Note, mode of file handle is unchanged.</span>
            <span class="n">fh</span> <span class="o">=</span> <span class="n">path</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">):</span>
            <span class="n">fh</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;path must be a string, path, or file handle.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fh</span>

    <span class="k">def</span> <span class="nf">_which</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Searches for name in exec path and returns full path&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">glob</span>
        <span class="kn">import</span> <span class="nn">platform</span>

        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="s2">&quot;.exe&quot;</span>

        <span class="n">paths</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PATH&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">):</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No prog </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> in path.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_handle_references</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph_attr</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_attr</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge_attr</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># ignore as likely still in __init__()</span></div>


<span class="k">class</span> <span class="nc">Node</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Node object based on unicode.</span>

<span class="sd">    If G is a graph</span>

<span class="sd">    &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">    &gt;&gt;&gt; G = pgv.AGraph()</span>

<span class="sd">    then</span>

<span class="sd">    &gt;&gt;&gt; G.add_node(1)</span>

<span class="sd">    will create a node object labeled by the string &quot;1&quot;.</span>

<span class="sd">    To get the object use</span>

<span class="sd">    &gt;&gt;&gt; node = pgv.Node(G, 1)</span>

<span class="sd">    or</span>
<span class="sd">    &gt;&gt;&gt; node = G.get_node(1)</span>

<span class="sd">    The node object is derived from a string and can be manipulated as such.</span>

<span class="sd">    Each node has attributes that can be directly accessed through</span>
<span class="sd">    the attr dictionary:</span>

<span class="sd">    &gt;&gt;&gt; node.attr[&quot;color&quot;] = &quot;red&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">nh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnameof</span><span class="p">(</span><span class="n">nh</span><span class="p">),</span> <span class="n">graph</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnode</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span> <span class="n">_Action</span><span class="o">.</span><span class="n">find</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> not in graph.&quot;</span><span class="p">)</span>

        <span class="n">n</span><span class="o">.</span><span class="n">ghandle</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">handle</span>
        <span class="n">n</span><span class="o">.</span><span class="n">attr</span> <span class="o">=</span> <span class="n">ItemAttribute</span><span class="p">(</span><span class="n">nh</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">n</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">nh</span>
        <span class="n">n</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">encoding</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">get_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return pointer to graphviz node object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ghandle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span> <span class="n">_Action</span><span class="o">.</span><span class="n">find</span><span class="p">)</span>

    <span class="c1">#    handle=property(get_handle)</span>

    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnameof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_name</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Edge</span><span class="p">(</span><span class="nb">tuple</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge object based on tuple.</span>

<span class="sd">    If G is a graph</span>

<span class="sd">    &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">    &gt;&gt;&gt; G = pgv.AGraph()</span>

<span class="sd">    then</span>

<span class="sd">    &gt;&gt;&gt; G.add_edge(1, 2)</span>

<span class="sd">    will add the edge 1-2 to the graph.</span>

<span class="sd">    &gt;&gt;&gt; edge = pgv.Edge(G, 1, 2)</span>

<span class="sd">    or</span>
<span class="sd">    &gt;&gt;&gt; edge = G.get_edge(1, 2)</span>

<span class="sd">    will get the edge object.</span>

<span class="sd">    An optional key can be used</span>

<span class="sd">    &gt;&gt;&gt; G.add_edge(2, 3, &quot;spam&quot;)</span>
<span class="sd">    &gt;&gt;&gt; edge = pgv.Edge(G, 2, 3, &quot;spam&quot;)</span>

<span class="sd">    The edge is represented as a tuple (u,v) or (u,v,key)</span>
<span class="sd">    and can be manipulated as such.</span>

<span class="sd">    Each edge has attributes that can be directly accessed through</span>
<span class="sd">    the attr dictionary:</span>

<span class="sd">    &gt;&gt;&gt; edge.attr[&quot;color&quot;] = &quot;red&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># edge handle given, reconstruct node object</span>
        <span class="k">if</span> <span class="n">eh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">agtail</span><span class="p">(</span><span class="n">eh</span><span class="p">),</span> <span class="n">gv</span><span class="o">.</span><span class="n">aghead</span><span class="p">(</span><span class="n">eh</span><span class="p">))</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">nh</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">nh</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
        <span class="c1"># no edge handle, search for edge and construct object</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">eh</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agedge</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">_Action</span><span class="o">.</span><span class="n">find</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2"> not in graph.&quot;</span><span class="p">)</span>

        <span class="n">tp</span> <span class="o">=</span> <span class="nb">tuple</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">ghandle</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">handle</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">eh</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">attr</span> <span class="o">=</span> <span class="n">ItemAttribute</span><span class="p">(</span><span class="n">eh</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">encoding</span>
        <span class="k">return</span> <span class="n">tp</span>

    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnameof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_name</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_name</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Attribute</span><span class="p">(</span><span class="n">MutableMapping</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Default attributes for graphs.</span>

<span class="sd">    Assigned on initialization of AGraph class.</span>
<span class="sd">    and manipulated through the class data.</span>

<span class="sd">    &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">    &gt;&gt;&gt; G = pgv.AGraph()  # initialize, G.graph_attr, G.node_attr, G.edge_attr</span>
<span class="sd">    &gt;&gt;&gt; G.graph_attr[&quot;splines&quot;] = &quot;true&quot;</span>
<span class="sd">    &gt;&gt;&gt; G.node_attr[&quot;shape&quot;] = &quot;circle&quot;</span>
<span class="sd">    &gt;&gt;&gt; G.edge_attr[&quot;color&quot;] = &quot;red&quot;</span>

<span class="sd">    See</span>
<span class="sd">    http://graphviz.org/doc/info/attrs.html</span>
<span class="sd">    for a list of all attributes.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># use for graph, node, and edge default attributes</span>
    <span class="c1"># atype:graph=0, node=1,edge=3</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">atype</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">handle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">atype</span>
        <span class="c1"># get the encoding</span>
        <span class="n">ghandle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agraphof</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
        <span class="n">root_handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agroot</span><span class="p">(</span><span class="n">ghandle</span><span class="p">)</span>  <span class="c1"># get root graph</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agattrdefval</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">agattr</span><span class="p">(</span><span class="n">root_handle</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;charset&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">item</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">bytes</span> <span class="k">else</span> <span class="n">item</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">_DEFAULT_ENCODING</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;charset&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Graph charset is immutable!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">ghandle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agroot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>  <span class="c1"># get root graph</span>
        <span class="k">if</span> <span class="n">ghandle</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">:</span>
            <span class="n">gv</span><span class="o">.</span><span class="n">agattr_label</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
                <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
                <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gv</span><span class="o">.</span><span class="n">agsafeset_label</span><span class="p">(</span>
                <span class="n">ghandle</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span>
                <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
                <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
                <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ah</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agattrdefval</span><span class="p">(</span><span class="n">ah</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">gv</span><span class="o">.</span><span class="n">agattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">has_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">yield</span> <span class="n">k</span>

    <span class="k">def</span> <span class="nf">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ah</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ah</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">ah</span><span class="p">)</span>
                <span class="k">yield</span> <span class="p">(</span>
                    <span class="n">gv</span><span class="o">.</span><span class="n">agattrname</span><span class="p">(</span><span class="n">ah</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
                    <span class="n">gv</span><span class="o">.</span><span class="n">agattrdefval</span><span class="p">(</span><span class="n">ah</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># gv.agattrdefval returned KeyError, skip</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>  <span class="c1"># gv.agnxtattr is done, as are we</span>
                <span class="k">return</span>


<span class="k">class</span> <span class="nc">ItemAttribute</span><span class="p">(</span><span class="n">Attribute</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Attributes for individual nodes and edges.</span>

<span class="sd">    Assigned on initialization of Node or Edge classes</span>
<span class="sd">    and manipulated through the class data.</span>

<span class="sd">    &gt;&gt;&gt; import pygraphviz as pgv</span>
<span class="sd">    &gt;&gt;&gt; G = pgv.AGraph()</span>
<span class="sd">    &gt;&gt;&gt; G.add_edge(&quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">    &gt;&gt;&gt; n = pgv.Node(G, &quot;a&quot;)</span>
<span class="sd">    &gt;&gt;&gt; n.attr[&quot;shape&quot;] = &quot;circle&quot;</span>
<span class="sd">    &gt;&gt;&gt; e = pgv.Edge(G, &quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">    &gt;&gt;&gt; e.attr[&quot;color&quot;] = &quot;red&quot;</span>

<span class="sd">    See</span>
<span class="sd">    http://graphviz.org/doc/info/attrs.html</span>
<span class="sd">    for a list of all attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># use for individual item attributes - either a node or an edge</span>
    <span class="c1"># graphs and default node and edge attributes use Attribute</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">atype</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">handle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">atype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ghandle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agraphof</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
        <span class="c1"># get the encoding</span>
        <span class="n">root_handle</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agroot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ghandle</span><span class="p">)</span>  <span class="c1"># get root graph</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agattrdefval</span><span class="p">(</span><span class="n">gv</span><span class="o">.</span><span class="n">agattr</span><span class="p">(</span><span class="n">root_handle</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;charset&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">item</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">bytes</span> <span class="k">else</span> <span class="n">item</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">_DEFAULT_ENCODING</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">N&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">gv</span><span class="o">.</span><span class="n">agsafeset_label</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ghandle</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span>
            <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
            <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
            <span class="n">default</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">val</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">gv</span><span class="o">.</span><span class="n">agset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ah</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ah</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ghandle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">ah</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agxget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">ah</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">defval</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agattrdefval</span><span class="p">(</span><span class="n">ah</span><span class="p">)</span>  <span class="c1"># default value</span>
                    <span class="k">if</span> <span class="n">defval</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                        <span class="k">continue</span>  <span class="c1"># don&#39;t report default</span>
                <span class="k">except</span><span class="p">:</span>  <span class="c1"># no default, gv.getattrdefval raised error</span>
                    <span class="k">pass</span>
                    <span class="c1"># unique value for this edge</span>
                <span class="k">yield</span> <span class="p">(</span>
                    <span class="n">gv</span><span class="o">.</span><span class="n">agattrname</span><span class="p">(</span><span class="n">ah</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
                    <span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># gv.agxget returned KeyError, skip</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>  <span class="c1"># gv.agnxtattr is done, as are we</span>
                <span class="k">return</span>

    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ah</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">attrdict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ah</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agnxtattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ghandle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">ah</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>  <span class="c1"># gv.agnxtattr is done, as are we</span>
                <span class="k">break</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agattrname</span><span class="p">(</span><span class="n">ah</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">agxget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">ah</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
            <span class="n">attrdict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">attrdict</span>
</pre></div>

           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2004-2022, PyGraphviz Developers.
      <span class="lastupdated">Last updated on May 07, 2022.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>